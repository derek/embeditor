<!DOCTYPE html>
<html>
    <head>
        <script src="js/ace.js" type="text/javascript" charset="utf-8"></script>
        
        <style>
            html, body{
                padding:0;
                margin:0;
            }
            #editor {
                width:100%;
                height:100%;
            }
        </style>
    </head>
    
    <body>
        <div id="editor"></div>
        <script>
            var editor = ace.edit("editor");
            
            var options = {};
            var querystring = window.location.href.split("?");
            if (querystring[1]) {
                var optionsArr = querystring[1].split("&");
                for(var i in optionsArr) {
                    var o = optionsArr[i].split("=");
                    options[o[0]] = o[1];
                }
            }
            
            switch(options.mode) {
                case "javascript":
                    loadScript("js/mode-javascript.js", function(){
                        var Mode = require("ace/mode/javascript").Mode;
                        editor.getSession().setMode(new Mode());
                    })    
                    break;
                case "html":
                    loadScript("js/mode-html.js", function(){
                        var Mode = require("ace/mode/html").Mode;
                        editor.getSession().setMode(new Mode());
                    })    
                    break;
                case "css":
                    loadScript("js/mode-css.js", function(){
                        var Mode = require("ace/mode/css").Mode;
                        editor.getSession().setMode(new Mode());
                    })    
                    break;
            }
            
            function loadScript(sScriptSrc, oCallback) {
                var oHead = document.getElementsByTagName('head')[0];
                var oScript = document.createElement('script');
                oScript.type = 'text/javascript';
                oScript.src = sScriptSrc;
                // most browsers
                oScript.onload = oCallback;
                // IE 6 & 7
                oScript.onreadystatechange = function() {
                    if (this.readyState == 'complete') {
                        oCallback();
                    }
                }
                oHead.appendChild(oScript);
            }
            
            /*parent.postMessage({
                message: "embeditorReady",
                windowName: window.name
            }, "*");*/
        </script>
    </body>

</html>